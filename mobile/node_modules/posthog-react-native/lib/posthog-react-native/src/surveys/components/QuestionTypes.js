"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:true});exports.LinkQuestion=LinkQuestion;exports.MultipleChoiceQuestion=MultipleChoiceQuestion;exports.OpenTextQuestion=OpenTextQuestion;exports.RatingButton=RatingButton;exports.RatingQuestion=RatingQuestion;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _icons=require("../icons");var _surveysUtils=require("../surveys-utils");var _src=require("../../../../posthog-core/src");var _BottomSection=require("./BottomSection");var _QuestionHeader=require("./QuestionHeader");var _jsxFileName="/home/runner/work/posthog-js-lite/posthog-js-lite/posthog-react-native/lib/posthog-react-native/src/surveys/components/QuestionTypes.js";function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{"default":e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n["default"]=e,t&&t.set(e,n),n;}function OpenTextQuestion(_ref){var question=_ref.question,appearance=_ref.appearance,_onSubmit=_ref.onSubmit;var _a;var _useState=(0,_react.useState)(''),_useState2=(0,_slicedToArray2["default"])(_useState,2),text=_useState2[0],setText=_useState2[1];return _react["default"].createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:11,columnNumber:13}},_react["default"].createElement(_QuestionHeader.QuestionHeader,{question:question.question,description:question.description,descriptionContentType:question.descriptionContentType,__self:this,__source:{fileName:_jsxFileName,lineNumber:12,columnNumber:7}}),_react["default"].createElement(_reactNative.View,{style:styles.textInputContainer,__self:this,__source:{fileName:_jsxFileName,lineNumber:13,columnNumber:7}},_react["default"].createElement(_reactNative.TextInput,{style:styles.textInput,multiline:true,numberOfLines:4,placeholder:appearance.placeholder,onChangeText:setText,value:text,__self:this,__source:{fileName:_jsxFileName,lineNumber:14,columnNumber:9}})),_react["default"].createElement(_BottomSection.BottomSection,{text:(_a=question.buttonText)!==null&&_a!==void 0?_a:appearance.submitButtonText,submitDisabled:!text&&!question.optional,appearance:appearance,onSubmit:function onSubmit(){return _onSubmit(text);},__self:this,__source:{fileName:_jsxFileName,lineNumber:16,columnNumber:7}}));}function LinkQuestion(_ref2){var question=_ref2.question,appearance=_ref2.appearance,_onSubmit2=_ref2.onSubmit;var _a,_b;question=question;return _react["default"].createElement(_react["default"].Fragment,null,_react["default"].createElement(_QuestionHeader.QuestionHeader,{question:question.question,description:question.description,descriptionContentType:question.descriptionContentType,__self:this,__source:{fileName:_jsxFileName,lineNumber:23,columnNumber:7}}),_react["default"].createElement(_BottomSection.BottomSection,{text:(_b=(_a=question.buttonText)!==null&&_a!==void 0?_a:appearance.submitButtonText)!==null&&_b!==void 0?_b:'Submit',submitDisabled:false,link:question.link,appearance:appearance,onSubmit:function onSubmit(){return _onSubmit2('link clicked');},__self:this,__source:{fileName:_jsxFileName,lineNumber:24,columnNumber:7}}));}function RatingQuestion(_ref3){var _this=this;var question=_ref3.question,appearance=_ref3.appearance,_onSubmit3=_ref3.onSubmit;var _a;var _useState3=(0,_react.useState)(null),_useState4=(0,_slicedToArray2["default"])(_useState3,2),rating=_useState4[0],setRating=_useState4[1];question=question;return _react["default"].createElement(_react["default"].Fragment,null,_react["default"].createElement(_QuestionHeader.QuestionHeader,{question:question.question,description:question.description,descriptionContentType:question.descriptionContentType,__self:this,__source:{fileName:_jsxFileName,lineNumber:33,columnNumber:7}}),_react["default"].createElement(_reactNative.View,{style:styles.ratingSection,__self:this,__source:{fileName:_jsxFileName,lineNumber:34,columnNumber:7}},_react["default"].createElement(_reactNative.View,{style:styles.ratingOptions,__self:this,__source:{fileName:_jsxFileName,lineNumber:35,columnNumber:9}},question.display===_src.SurveyRatingDisplay.Emoji&&_react["default"].createElement(_reactNative.View,{style:styles.ratingOptionsEmoji,__self:this,__source:{fileName:_jsxFileName,lineNumber:36,columnNumber:63}},(question.scale===3?threeScaleEmojis:fiveScaleEmojis).map(function(Emoji,idx){var active=idx+1===rating;return _react["default"].createElement(_reactNative.TouchableOpacity,{key:idx,style:styles.ratingsEmoji,onPress:function onPress(){return setRating(idx+1);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:39,columnNumber:25}},_react["default"].createElement(Emoji,{fill:active?appearance.ratingButtonActiveColor:appearance.ratingButtonColor,__self:_this,__source:{fileName:_jsxFileName,lineNumber:40,columnNumber:21}}));})),question.display===_src.SurveyRatingDisplay.Number&&_react["default"].createElement(_reactNative.View,{style:[styles.ratingOptionsNumber,{borderColor:appearance.borderColor}],__self:this,__source:{fileName:_jsxFileName,lineNumber:44,columnNumber:64}},getScaleNumbers(question.scale).map(function(number,idx){var active=rating===number;return _react["default"].createElement(RatingButton,{key:idx,index:idx,active:active,appearance:appearance,num:number,setActiveNumber:setRating,__self:_this,__source:{fileName:_jsxFileName,lineNumber:47,columnNumber:25}});}))),_react["default"].createElement(_reactNative.View,{style:styles.ratingText,__self:this,__source:{fileName:_jsxFileName,lineNumber:51,columnNumber:9}},_react["default"].createElement(_reactNative.Text,{__self:this,__source:{fileName:_jsxFileName,lineNumber:52,columnNumber:11}},question.lowerBoundLabel),_react["default"].createElement(_reactNative.Text,{__self:this,__source:{fileName:_jsxFileName,lineNumber:53,columnNumber:11}},question.upperBoundLabel))),_react["default"].createElement(_BottomSection.BottomSection,{text:(_a=question.buttonText)!==null&&_a!==void 0?_a:appearance.submitButtonText,submitDisabled:rating===null&&!question.optional,appearance:appearance,onSubmit:function onSubmit(){return _onSubmit3(rating);},__self:this,__source:{fileName:_jsxFileName,lineNumber:56,columnNumber:7}}));}function RatingButton(_ref4){var index=_ref4.index,num=_ref4.num,active=_ref4.active,appearance=_ref4.appearance,setActiveNumber=_ref4.setActiveNumber;var backgroundColor=active?appearance.ratingButtonActiveColor:appearance.ratingButtonColor;var textColor=(0,_surveysUtils.getContrastingTextColor)(backgroundColor);return _react["default"].createElement(_reactNative.TouchableOpacity,{style:[styles.ratingsNumber,index===0&&{borderLeftWidth:0},{backgroundColor:backgroundColor,borderColor:appearance.borderColor}],onPress:function onPress(){return setActiveNumber(num);},__self:this,__source:{fileName:_jsxFileName,lineNumber:62,columnNumber:13}},_react["default"].createElement(_reactNative.Text,{style:{color:textColor},__self:this,__source:{fileName:_jsxFileName,lineNumber:67,columnNumber:7}},num));}function MultipleChoiceQuestion(_ref5){var _this2=this;var question=_ref5.question,appearance=_ref5.appearance,_onSubmit4=_ref5.onSubmit;var _a;question=question;var allowMultiple=question.type===_src.SurveyQuestionType.MultipleChoice;var openChoice=question.hasOpenChoice?question.choices[question.choices.length-1]:null;var choices=(0,_react.useMemo)(function(){return(0,_surveysUtils.getDisplayOrderChoices)(question);},[question]);var _useState5=(0,_react.useState)([]),_useState6=(0,_slicedToArray2["default"])(_useState5,2),selectedChoices=_useState6[0],setSelectedChoices=_useState6[1];var _useState7=(0,_react.useState)(''),_useState8=(0,_slicedToArray2["default"])(_useState7,2),openEndedInput=_useState8[0],setOpenEndedInput=_useState8[1];return _react["default"].createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:78,columnNumber:13}},_react["default"].createElement(_QuestionHeader.QuestionHeader,{question:question.question,description:question.description,descriptionContentType:question.descriptionContentType,__self:this,__source:{fileName:_jsxFileName,lineNumber:79,columnNumber:7}}),_react["default"].createElement(_reactNative.View,{style:styles.multipleChoiceOptions,__self:this,__source:{fileName:_jsxFileName,lineNumber:80,columnNumber:7}},choices.map(function(choice,idx){var isOpenChoice=choice===openChoice;var isSelected=selectedChoices.includes(choice);return _react["default"].createElement(_reactNative.Pressable,{key:idx,style:[styles.choiceOption,isSelected?{borderColor:'black'}:{}],onPress:function onPress(){if(allowMultiple){setSelectedChoices(isSelected?selectedChoices.filter(function(c){return c!==choice;}):[].concat((0,_toConsumableArray2["default"])(selectedChoices),[choice]));}else{setSelectedChoices([choice]);}},__self:_this2,__source:{fileName:_jsxFileName,lineNumber:84,columnNumber:21}},_react["default"].createElement(_reactNative.View,{style:styles.choiceText,__self:_this2,__source:{fileName:_jsxFileName,lineNumber:92,columnNumber:15}},_react["default"].createElement(_reactNative.Text,{style:{flexGrow:1},__self:_this2,__source:{fileName:_jsxFileName,lineNumber:93,columnNumber:17}},choice,isOpenChoice?':':''),_react["default"].createElement(_reactNative.View,{style:styles.rightCheckArea,__self:_this2,__source:{fileName:_jsxFileName,lineNumber:97,columnNumber:17}},isSelected&&_react["default"].createElement(_icons.CheckSVG,{__self:_this2,__source:{fileName:_jsxFileName,lineNumber:97,columnNumber:68}}))),isOpenChoice&&_react["default"].createElement(_reactNative.TextInput,{style:styles.openEndedInput,onChangeText:function onChangeText(userValue){setOpenEndedInput(userValue);if(!isSelected){setSelectedChoices(allowMultiple?[].concat((0,_toConsumableArray2["default"])(selectedChoices),[choice]):[choice]);}},__self:_this2,__source:{fileName:_jsxFileName,lineNumber:99,columnNumber:33}}));})),_react["default"].createElement(_BottomSection.BottomSection,{text:(_a=question.buttonText)!==null&&_a!==void 0?_a:appearance.submitButtonText,submitDisabled:!question.optional&&(selectedChoices.length===0||openChoice!==null&&selectedChoices.includes(openChoice)&&openEndedInput.length===0),appearance:appearance,onSubmit:function onSubmit(){var result=selectedChoices.map(function(c){return c===openChoice?openEndedInput:c;});_onSubmit4(result.length===1?result[0]:result);},__self:this,__source:{fileName:_jsxFileName,lineNumber:108,columnNumber:7}}));}var threeScaleEmojis=[_icons.DissatisfiedEmoji,_icons.NeutralEmoji,_icons.SatisfiedEmoji];var fiveScaleEmojis=[_icons.VeryDissatisfiedEmoji,_icons.DissatisfiedEmoji,_icons.NeutralEmoji,_icons.SatisfiedEmoji,_icons.VerySatisfiedEmoji];var fiveScaleNumbers=[1,2,3,4,5];var sevenScaleNumbers=[1,2,3,4,5,6,7];var tenScaleNumbers=[0,1,2,3,4,5,6,7,8,9,10];function getScaleNumbers(scale){switch(scale){case 5:return fiveScaleNumbers;case 7:return sevenScaleNumbers;case 10:return tenScaleNumbers;default:return fiveScaleNumbers;}}var styles=_reactNative.StyleSheet.create({textInputContainer:{padding:10},textInput:{borderColor:'#ccc',borderWidth:1,padding:10,marginVertical:10,backgroundColor:'white',fontSize:16},ratingSection:{marginVertical:10},ratingOptions:{flexDirection:'row',justifyContent:'space-between'},ratingOptionsEmoji:{flexDirection:'row',justifyContent:'space-between',flexWrap:'wrap'},ratingsEmoji:{padding:10},ratingOptionsNumber:{margin:10,flexGrow:1,flexDirection:'row',justifyContent:'space-between',borderRadius:5,borderWidth:1,overflow:'hidden'},ratingsNumber:{flex:1,paddingVertical:10,alignItems:'center',borderLeftWidth:1},ratingText:{flexDirection:'row',justifyContent:'space-between',padding:10},multipleChoiceOptions:{padding:10},choiceOption:{flexDirection:'column',marginVertical:5,borderWidth:1,borderColor:'grey',borderRadius:5,padding:10,backgroundColor:'white'},choiceText:{flexDirection:'row'},rightCheckArea:{flexGrow:0},openEndedInput:{padding:5}});