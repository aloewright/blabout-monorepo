"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:true});exports.SurveyModal=SurveyModal;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _Cancel=require("./Cancel");var _ConfirmationMessage=require("./ConfirmationMessage");var _Surveys=require("./Surveys");var _src=require("../../../../posthog-core/src");var _OptionalReactNativeSafeArea=require("../../optional/OptionalReactNativeSafeArea");var _jsxFileName="/home/runner/work/posthog-js-lite/posthog-js-lite/posthog-react-native/lib/posthog-react-native/src/surveys/components/SurveyModal.js";function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return{"default":e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n["default"]=e,t&&t.set(e,n),n;}function SurveyModal(props){var _a;var survey=props.survey,appearance=props.appearance,onShow=props.onShow;var _useState=(0,_react.useState)(false),_useState2=(0,_slicedToArray2["default"])(_useState,2),isSurveySent=_useState2[0],setIsSurveySent=_useState2[1];var onClose=(0,_react.useCallback)(function(){return props.onClose(isSurveySent);},[isSurveySent,props]);var insets=(0,_OptionalReactNativeSafeArea.useOptionalSafeAreaInsets)();var _useState3=(0,_react.useState)(true),_useState4=(0,_slicedToArray2["default"])(_useState3,1),isVisible=_useState4[0];var shouldShowConfirmation=isSurveySent&&appearance.thankYouMessageHeader;(0,_react.useEffect)(function(){if(isVisible){onShow();}},[isVisible,onShow]);if(!isVisible){return null;}return _react["default"].createElement(_reactNative.Modal,{animationType:"fade",transparent:true,onRequestClose:onClose,statusBarTranslucent:true,__self:this,__source:{fileName:_jsxFileName,lineNumber:24,columnNumber:13}},_react["default"].createElement(_reactNative.KeyboardAvoidingView,{behavior:_reactNative.Platform.OS==='ios'?'padding':'height',style:{flex:1,justifyContent:'flex-end'},keyboardVerticalOffset:_reactNative.Platform.OS==='ios'?10:0,__self:this,__source:{fileName:_jsxFileName,lineNumber:25,columnNumber:7}},_react["default"].createElement(_reactNative.TouchableWithoutFeedback,{onPress:_reactNative.Keyboard.dismiss,accessible:false,__self:this,__source:{fileName:_jsxFileName,lineNumber:26,columnNumber:9}},_react["default"].createElement(_reactNative.View,{style:styles.modalBackdrop,__self:this,__source:{fileName:_jsxFileName,lineNumber:27,columnNumber:11}},_react["default"].createElement(_reactNative.Pressable,{style:_reactNative.StyleSheet.absoluteFill,onPress:onClose,accessible:false,__self:this,__source:{fileName:_jsxFileName,lineNumber:28,columnNumber:13}}),_react["default"].createElement(_reactNative.View,{style:[styles.modalContent,{borderColor:appearance.borderColor,backgroundColor:appearance.backgroundColor,marginBottom:insets.bottom+10,marginHorizontal:10}],__self:this,__source:{fileName:_jsxFileName,lineNumber:29,columnNumber:13}},!shouldShowConfirmation?_react["default"].createElement(_Surveys.Questions,{survey:survey,appearance:appearance,onSubmit:function onSubmit(){return setIsSurveySent(true);},__self:this,__source:{fileName:_jsxFileName,lineNumber:38,columnNumber:43}}):_react["default"].createElement(_ConfirmationMessage.ConfirmationMessage,{appearance:appearance,header:appearance.thankYouMessageHeader,description:appearance.thankYouMessageDescription,contentType:(_a=appearance.thankYouMessageDescriptionContentType)!==null&&_a!==void 0?_a:_src.SurveyQuestionDescriptionContentType.Text,onClose:onClose,isModal:true,__self:this,__source:{fileName:_jsxFileName,lineNumber:38,columnNumber:139}}),_react["default"].createElement(_reactNative.View,{style:styles.topIconContainer,__self:this,__source:{fileName:_jsxFileName,lineNumber:39,columnNumber:15}},_react["default"].createElement(_Cancel.Cancel,{onPress:onClose,appearance:appearance,__self:this,__source:{fileName:_jsxFileName,lineNumber:40,columnNumber:17}})))))));}var styles=_reactNative.StyleSheet.create({modalBackdrop:{flex:1,justifyContent:'flex-end'},modalContent:{borderRadius:10,borderWidth:1,padding:20,width:'90%',maxWidth:400,marginHorizontal:20},topIconContainer:{position:'absolute',right:-20,top:-20}});